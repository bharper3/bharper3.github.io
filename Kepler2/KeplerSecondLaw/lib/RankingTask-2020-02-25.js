!function(t){var e={};function i(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(n,s,function(e){return t[e]}.bind(null,s));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=6)}([function(t,e,i){"use strict";var n,s;"undefined"!=typeof window&&window,void 0===(s="function"==typeof(n=function(){if("undefined"==typeof window)return null;var t="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")(),e=t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||function(e){return t.setTimeout(e,20)},i=t.cancelAnimationFrame||t.mozCancelAnimationFrame||t.webkitCancelAnimationFrame||function(e){t.clearTimeout(e)};function n(t,e){var i=Object.prototype.toString.call(t),n="[object Array]"===i||"[object NodeList]"===i||"[object HTMLCollection]"===i||"[object Object]"===i||"undefined"!=typeof jQuery&&t instanceof jQuery||"undefined"!=typeof Elements&&t instanceof Elements,s=0,o=t.length;if(n)for(;s<o;s++)e(t[s]);else e(t)}function s(t){if(!t.getBoundingClientRect)return{width:t.offsetWidth,height:t.offsetHeight};var e=t.getBoundingClientRect();return{width:Math.round(e.width),height:Math.round(e.height)}}function o(t,e){Object.keys(e).forEach((function(i){t.style[i]=e[i]}))}var r=function(t,a){var h=0;function d(){var t,e,i=[];this.add=function(t){i.push(t)},this.call=function(n){for(t=0,e=i.length;t<e;t++)i[t].call(this,n)},this.remove=function(n){var s=[];for(t=0,e=i.length;t<e;t++)i[t]!==n&&s.push(i[t]);i=s},this.length=function(){return i.length}}function c(t,i){if(t)if(t.resizedAttached)t.resizedAttached.add(i);else{t.resizedAttached=new d,t.resizedAttached.add(i),t.resizeSensor=document.createElement("div"),t.resizeSensor.dir="ltr",t.resizeSensor.className="resize-sensor";var n={pointerEvents:"none",position:"absolute",left:"0px",top:"0px",right:"0px",bottom:"0px",overflow:"hidden",zIndex:"-1",visibility:"hidden",maxWidth:"100%"},r={position:"absolute",left:"0px",top:"0px",transition:"0s"};o(t.resizeSensor,n);var a=document.createElement("div");a.className="resize-sensor-expand",o(a,n);var c=document.createElement("div");o(c,r),a.appendChild(c);var l=document.createElement("div");l.className="resize-sensor-shrink",o(l,n);var _=document.createElement("div");o(_,r),o(_,{width:"200%",height:"200%"}),l.appendChild(_),t.resizeSensor.appendChild(a),t.resizeSensor.appendChild(l),t.appendChild(t.resizeSensor);var m=window.getComputedStyle(t),u=m?m.getPropertyValue("position"):null;"absolute"!==u&&"relative"!==u&&"fixed"!==u&&"sticky"!==u&&(t.style.position="relative");var g=!1,p=0,f=s(t),v=0,y=0,b=!0;h=0;var w=function(){if(b){if(0===t.offsetWidth&&0===t.offsetHeight)return void(h||(h=e((function(){h=0,w()}))));b=!1}var i,n;i=t.offsetWidth,n=t.offsetHeight,c.style.width=i+10+"px",c.style.height=n+10+"px",a.scrollLeft=i+10,a.scrollTop=n+10,l.scrollLeft=i+10,l.scrollTop=n+10};t.resizeSensor.resetSensor=w;var I=function(){p=0,g&&(v=f.width,y=f.height,t.resizedAttached&&t.resizedAttached.call(f))},E=function(){f=s(t),(g=f.width!==v||f.height!==y)&&!p&&(p=e(I)),w()},D=function(t,e,i){t.attachEvent?t.attachEvent("on"+e,i):t.addEventListener(e,i)};D(a,"scroll",E),D(l,"scroll",E),h=e((function(){h=0,w()}))}}n(t,(function(t){c(t,a)})),this.detach=function(e){h||(i(h),h=0),r.detach(t,e)},this.reset=function(){t.resizeSensor.resetSensor()}};if(r.reset=function(t){n(t,(function(t){t.resizeSensor.resetSensor()}))},r.detach=function(t,e){n(t,(function(t){t&&(t.resizedAttached&&"function"==typeof e&&(t.resizedAttached.remove(e),t.resizedAttached.length())||t.resizeSensor&&(t.contains(t.resizeSensor)&&t.removeChild(t.resizeSensor),delete t.resizeSensor,delete t.resizedAttached))}))},"undefined"!=typeof MutationObserver){var a=new MutationObserver((function(t){for(var e in t)if(t.hasOwnProperty(e))for(var i=t[e].addedNodes,n=0;n<i.length;n++)i[n].resizeSensor&&r.reset(i[n])}));document.addEventListener("DOMContentLoaded",(function(t){a.observe(document.body,{childList:!0,subtree:!0})}))}return r})?n.call(e,i,e,t):n)||(t.exports=s)},function(t,e,i){var n=i(2);"string"==typeof n&&(n=[[t.i,n,""]]);var s={hmr:!0,transform:void 0,insertInto:void 0};i(4)(n,s);n.locals&&(t.exports=n.locals)},function(t,e,i){(t.exports=i(3)(!1)).push([t.i,"/*\nRankingTask.css\nranking-task\nastro.unl.edu\n2020-02-12\n*/\n\n/*\nThe grabbing layer is a transparent overlay for displaying the\ngrabbing cursor.\n*/\n\n.rt-grabbing-layer {\n  position: fixed;\n  z-index: 15151;\n  left: 0;\n  top: 0;\n  width: 100%;\n  height: 100%;\n  background-color: transparent; /*rgba(255, 0, 0, 0.2);*/\n  cursor: -moz-grabbing;\n  cursor: -webkit-grabbing;\n  cursor: grabbing;\n}\n\n.rt-root {\n  font-family: Helvetica, Arial, sans-serif;\n  font-weight: normal;\n  background-color: white;\n  border: 1px solid #aaa;\n  width: 100%;\n  margin: 1rem 0rem;\n  padding: 1rem;\n  box-sizing: border-box;\n  overflow: hidden;\n}\n\n.rt-inner {\n  position: relative;\n  width: 100%;\n  height: 100%;\n  margin: 0px;\n  padding: 0px;\n/*  background-color: lightgrey;*/\n}\n\n.rt-question {\n  position: absolute;\n  margin: 0px;\n  font-size: 1.15rem;\n/*  background-color: lightblue;*/\n}\n\n.rt-items {\n  position: absolute;\n  margin: 0px;\n/*  background-color: pink;*/\n}\n\n.rt-footer {\n  position: absolute;\n  margin: 0px;\n  height: 1.15rem;\n/*  background-color: orange;*/\n}\n\n/*\n * Media\n*/\n\n.rt-media {\n  position: absolute;\n  margin: 0;\n  padding: 0;\n/*  background-color: lightgreen;*/\n}\n\n.rt-media-img-container {\n  position: absolute;\n  margin: 0;\n  padding: 0;\n}\n\n.rt-media-img {\n  position: absolute;\n  margin: 0;\n  padding: 0;\n  width: 100%;\n  height: 100%;\n}\n\n/*\n * Item\n*/\n\n.rt-item {\n  position: absolute;\n  margin: 0;\n  padding: 0;\n  cursor: default;\n  -moz-user-select: none;\n  -webkit-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n}\n\n.rt-item-img-container {\n  position: absolute;\n  margin: 0;\n  padding: 0;\n}\n\n.rt-item-img {\n  margin: 0;\n  padding: 0;\n  width: 100%;\n  height: 100%;\n}\n\n.rt-item-review-container {\n  display: table;\n  max-width: 80%;\n  position: absolute;\n  transform: translateX(-50%);\n  padding: 0.6rem;\n  border: 2px solid #000;\n  background-color: white;\n  z-index: 2;\n  border-radius: 0.35rem;\n}\n\n.rt-item-review-feedback {\n  display: table;\n  text-align: center;\n}\n\n.rt-item-review-order {\n  font-weight: bold;\n  font-size: 1.5rem;\n  text-align: center;\n  width: 100%;\n  display: inline-block;\n}\n\n.rt-item-label {\n  display: table;\n  margin: 0px;\n  padding: 0.4em;\n  position: absolute;\n  transform: translateX(-50%);\n  border: 2px solid #000;\n  background-color: rgba(255, 255, 255, 1.0);\n  z-index: 1;\n  border-radius: 0.35rem;\n  text-align: center;\n}\n\n\n/*\n * Footer\n*/\n\n.rt-footer-left {\n  vertical-align: top;\n  width: 20%;\n  min-height: 1px;\n/*  background-color: #ffaaaa;*/\n  display: inline-block;\n}\n\n.rt-footer-center {\n  vertical-align: top;\n  width: 60%;\n  min-height: 1px;\n/*  background-color: #aaffaa;*/\n  display: inline-block;\n}\n\n.rt-footer-right {\n  vertical-align: top;\n  width: 20%;\n  min-height: 1px;\n/*  background-color: #aaaaff;*/\n  display: inline-block;\n}\n\n.rt-background-button {\n  float: left;\n  margin: 0em;\n}\n\n.rt-feedback {\n  vertical-align: text-top;\n  text-align: center;\n  margin: 0em 1em;\n  font-size: 1.15rem;\n/*  background-color: lightgray;*/\n}\n\n.rt-action-button {\n  float: right;\n  margin: 0em;\n}\n\n\n/*\n * These cursor classes are the bottom so that they take precedence.\n*/\n\n.rt-normal-cursor {\n  cursor: default;\n}\n\n.rt-grab-cursor {\n  cursor: -moz-grab;\n  cursor: -webkit-grab;\n  cursor: grab;\n}\n\n",""])},function(t,e){t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var i=function(t,e){var i=t[1]||"",n=t[3];if(!n)return i;if(e&&"function"==typeof btoa){var s=(r=n,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */"),o=n.sources.map((function(t){return"/*# sourceURL="+n.sourceRoot+t+" */"}));return[i].concat(o).concat([s]).join("\n")}var r;return[i].join("\n")}(e,t);return e[2]?"@media "+e[2]+"{"+i+"}":i})).join("")},e.i=function(t,i){"string"==typeof t&&(t=[[null,t,""]]);for(var n={},s=0;s<this.length;s++){var o=this[s][0];"number"==typeof o&&(n[o]=!0)}for(s=0;s<t.length;s++){var r=t[s];"number"==typeof r[0]&&n[r[0]]||(i&&!r[2]?r[2]=i:i&&(r[2]="("+r[2]+") and ("+i+")"),e.push(r))}},e}},function(t,e,i){var n,s,o={},r=(n=function(){return window&&document&&document.all&&!window.atob},function(){return void 0===s&&(s=n.apply(this,arguments)),s}),a=function(t,e){return e?e.querySelector(t):document.querySelector(t)},h=function(t){var e={};return function(t,i){if("function"==typeof t)return t();if(void 0===e[t]){var n=a.call(this,t,i);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}}(),d=null,c=0,l=[],_=i(5);function m(t,e){for(var i=0;i<t.length;i++){var n=t[i],s=o[n.id];if(s){s.refs++;for(var r=0;r<s.parts.length;r++)s.parts[r](n.parts[r]);for(;r<n.parts.length;r++)s.parts.push(y(n.parts[r],e))}else{var a=[];for(r=0;r<n.parts.length;r++)a.push(y(n.parts[r],e));o[n.id]={id:n.id,refs:1,parts:a}}}}function u(t,e){for(var i=[],n={},s=0;s<t.length;s++){var o=t[s],r=e.base?o[0]+e.base:o[0],a={css:o[1],media:o[2],sourceMap:o[3]};n[r]?n[r].parts.push(a):i.push(n[r]={id:r,parts:[a]})}return i}function g(t,e){var i=h(t.insertInto);if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var n=l[l.length-1];if("top"===t.insertAt)n?n.nextSibling?i.insertBefore(e,n.nextSibling):i.appendChild(e):i.insertBefore(e,i.firstChild),l.push(e);else if("bottom"===t.insertAt)i.appendChild(e);else{if("object"!=typeof t.insertAt||!t.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var s=h(t.insertAt.before,i);i.insertBefore(e,s)}}function p(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=l.indexOf(t);e>=0&&l.splice(e,1)}function f(t){var e=document.createElement("style");if(void 0===t.attrs.type&&(t.attrs.type="text/css"),void 0===t.attrs.nonce){var n=function(){0;return i.nc}();n&&(t.attrs.nonce=n)}return v(e,t.attrs),g(t,e),e}function v(t,e){Object.keys(e).forEach((function(i){t.setAttribute(i,e[i])}))}function y(t,e){var i,n,s,o;if(e.transform&&t.css){if(!(o="function"==typeof e.transform?e.transform(t.css):e.transform.default(t.css)))return function(){};t.css=o}if(e.singleton){var r=c++;i=d||(d=f(e)),n=I.bind(null,i,r,!1),s=I.bind(null,i,r,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(i=function(t){var e=document.createElement("link");return void 0===t.attrs.type&&(t.attrs.type="text/css"),t.attrs.rel="stylesheet",v(e,t.attrs),g(t,e),e}(e),n=D.bind(null,i,e),s=function(){p(i),i.href&&URL.revokeObjectURL(i.href)}):(i=f(e),n=E.bind(null,i),s=function(){p(i)});return n(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;n(t=e)}else s()}}t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||"boolean"==typeof e.singleton||(e.singleton=r()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var i=u(t,e);return m(i,e),function(t){for(var n=[],s=0;s<i.length;s++){var r=i[s];(a=o[r.id]).refs--,n.push(a)}t&&m(u(t,e),e);for(s=0;s<n.length;s++){var a;if(0===(a=n[s]).refs){for(var h=0;h<a.parts.length;h++)a.parts[h]();delete o[a.id]}}}};var b,w=(b=[],function(t,e){return b[t]=e,b.filter(Boolean).join("\n")});function I(t,e,i,n){var s=i?"":n.css;if(t.styleSheet)t.styleSheet.cssText=w(e,s);else{var o=document.createTextNode(s),r=t.childNodes;r[e]&&t.removeChild(r[e]),r.length?t.insertBefore(o,r[e]):t.appendChild(o)}}function E(t,e){var i=e.css,n=e.media;if(n&&t.setAttribute("media",n),t.styleSheet)t.styleSheet.cssText=i;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(i))}}function D(t,e,i){var n=i.css,s=i.sourceMap,o=void 0===e.convertToAbsoluteUrls&&s;(e.convertToAbsoluteUrls||o)&&(n=_(n)),s&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(s))))+" */");var r=new Blob([n],{type:"text/css"}),a=t.href;t.href=URL.createObjectURL(r),a&&URL.revokeObjectURL(a)}},function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var i=e.protocol+"//"+e.host,n=i+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,(function(t,e){var s,o=e.trim().replace(/^"(.*)"$/,(function(t,e){return e})).replace(/^'(.*)'$/,(function(t,e){return e}));return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(o)?t:(s=0===o.indexOf("//")?o:0===o.indexOf("/")?i+o:n+o.replace(/^\.\//,""),"url("+JSON.stringify(s)+")")}))}},function(t,e,i){"use strict";i.r(e);var n=i(0),s=i.n(n);i(1);function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){var i=this;if(null==t||"object"!==o(t))throw new Error("A ranking task definition object is required.");if(!this._isString(t.question))throw new Error("A ranking task definition must have a question property (a string).");if(this.question=t.question.slice(0),!Array.isArray(t.bins))throw new Error("A ranking task definition must have a bins array.");this.bins=[];for(var n=function(){var n=i._copyBin(t.bins[s],e),o=n.id;i.bins.forEach((function(t){if(t.id===o)throw new Error("All bin IDs must be unique. '"+o+"' is assigned more than once.")})),i.bins.push(n)},s=0;s<t.bins.length;++s)n();if(this._isIdentifierString(t.id)&&(this.id=t.id.slice(0)),this._isString(t.name)&&(this.name=t.name.slice(0)),void 0!==t.media&&(this.media=this._copyMedia(t.media,e),"labeledImage"===this.media.type)){var r=!0,a=!1,h=void 0;try{for(var d,c=this.bins[Symbol.iterator]();!(r=(d=c.next()).done);r=!0){var l=d.value,_=!0,m=!1,u=void 0;try{for(var g,p=l.items[Symbol.iterator]();!(_=(g=p.next()).done);_=!0){if("label"!==g.value.type)throw new Error("All items must be of the 'label' type when media of type 'labeledImage' is used.")}}catch(t){m=!0,u=t}finally{try{_||null==p.return||p.return()}finally{if(m)throw u}}}}catch(t){a=!0,h=t}finally{try{r||null==c.return||c.return()}finally{if(a)throw h}}}if(void 0!==t.background&&(this.background=this._copyBackground(t.background,e)),void 0!==t.numToSelect){var f=parseInt(t.numToSelect);!Number.isNaN(f)&&Number.isFinite(f)&&f>0?this.numToSelect=f:Array.isArray(e)&&e.push("If defined, the definition object's numToSelect must be a positive integer.")}this._isString(t.key)&&(this.key=t.key.slice(0))}function a(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}r.prototype._copyBackground=function(t,e){if("object"===o(t))if(this._isString(t.src)){if(""!==t.src)return{src:t.src.slice(0)};Array.isArray(e)&&e.push("The background src property is empty.")}else Array.isArray(e)&&e.push("The background object must have a src property.");else Array.isArray(e)&&e.push("The background property, if defined, must be an object.")},r.prototype._copyMedia=function(t,e){var i={};if("object"!==o(t))throw new Error("The media property, if defined, must be an object.");if("image"===t.type)i.type="image",this._finishImageMediaCopy(t,i,e);else{if("labeledImage"!==t.type)throw new Error("The media object must have a valid type property.");i.type="labeledImage",this._finishImageMediaCopy(t,i,e)}return i},r.prototype._finishImageMediaCopy=function(t,e,i){if(!this._isString(t.src))throw new Error("An image media object must have a src property.");if(e.src=t.src.slice(0),void 0!==t.width){var n=parseFloat(t.width);!Number.isNaN(n)&&Number.isFinite(n)&&n>0?e.width=n:Array.isArray(i)&&i.push("The media object's width property is invalid.")}if(void 0!==t.height){var s=parseFloat(t.height);!Number.isNaN(s)&&Number.isFinite(s)&&s>0?e.height=s:Array.isArray(i)&&i.push("The media object's height property is invalid.")}if(void 0!==t.itemSize){var o=parseFloat(t.itemSize);!Number.isNaN(o)&&Number.isFinite(o)&&o>=30&&o<=300?e.itemSize=o:Array.isArray(i)&&i.push("The media object's itemSize property is invalid.")}if(void 0!==t.labelSize){var r=parseFloat(t.labelSize);!Number.isNaN(r)&&Number.isFinite(r)&&r>=.01&&r<=.3?e.labelSize=r:Array.isArray(i)&&i.push("The media object's labelSize property is invalid.")}},r.prototype._copyBin=function(t,e){var i=this,n={};if(!Array.isArray(t.items))throw new Error("A bin object must have an items array.");n.items=[];for(var s=function(){var s=i._copyItem(t.items[o],e),r=s.id.slice(0);n.items.forEach((function(t){if(t.id===r)throw new Error("All item IDs must be unique within a bin. '"+r+"' is assigned more than once.")})),n.items.push(s)},o=0;o<t.items.length;++o)s();return this._isIdentifierString(t.id)&&(n.id=t.id.slice(0)),this._isString(t.key)&&(n.key=t.key.slice(0)),n},r.prototype._copyItem=function(t,e){var i={};if(!this._isIdentifierString(t.id))throw new Error("All item objects must have a valid ID property.");if(i.id=t.id.slice(0),!this._isString(t.type))throw new Error("All item objects must have a type property.");if("image"===t.type)i.type="image",this._finishImageItemCopy(t,i,e);else{if("label"!==t.type)throw new Error("All item objects must have a valid type property ('"+t.type+"' is not recognized).");i.type="label",this._finishLabelItemCopy(t,i,e)}if(this._isString(t.key)&&(i.key=t.key.slice(0)),void 0!==t.value){var n=parseFloat(t.value);!Number.isNaN(n)&&Number.isFinite(n)?i.value=n:Array.isArray(e)&&e.push("The value property for item with ID '"+i.id+"' is not valid.")}if(void 0!==t.label&&(this._isString(t.label)?""===t.label?e.push("The label property for item with ID '"+i.id+"' is an empty string."):i.label=t.label.slice(0):this._isNumber(t.label)?i.label=t.label:e.push("The label property for item with ID '"+i.id+"' is not valid (it must be a string or a number).")),void 0!==t.feedback&&(this._isString(t.feedback)?""===t.feedback?e.push("The feedback property for the item with ID '"+i.id+"' is an empty string."):i.feedback=t.feedback.slice(0):this._isNumber(t.feedback)?i.feedback=t.feedback:e.push("The feedback property for item with ID '"+i.id+"' is not valid (it must be a string or a number).")),void 0!==t.order){var s=parseInt(t.order);!Number.NaN(s)&&Number.isFinite(s)&&s>=1?i.order=s:Array.isArray(e)&&e.push("The order property for an item is invalid.")}return void 0!==t.isCorrect?i.isCorrect=Boolean(t.isCorrect):void 0!==i.order&&e.push("The order property of an item is defined but isCorrect is not."),i},r.prototype._finishLabelItemCopy=function(t,e,i){if(void 0===t.x)throw new Error("Label items must have an x property.");var n=parseFloat(t.x);if(!(!Number.isNaN(n)&&Number.isFinite(n)&&n>=0&&n<=1))throw new Error("A label item must have a valid x property in the range 0.0 to 1.0.");if(e.x=n,void 0===t.x)throw new Error("Label items must have an y property.");var s=parseFloat(t.y);if(!(!Number.isNaN(s)&&Number.isFinite(s)&&s>=0&&s<=1))throw new Error("A label item must have a valid y property in the range 0.0 to 1.0.");e.y=s},r.prototype._finishImageItemCopy=function(t,e,i){if(!this._isString(t.src))throw new Error("Image items must have a src property.");if(e.src=t.src.slice(0),void 0!==t.width){var n=parseFloat(t.width);!Number.isNaN(n)&&Number.isFinite(n)&&n>0?e.width=n:Array.isArray(i)&&i.push("If defined, an image item's width must be a finite number greater than zero.")}if(void 0!==t.height){var s=parseFloat(t.height);!Number.isNaN(s)&&Number.isFinite(s)&&s>0?e.height=s:Array.isArray(i)&&i.push("If defined, an image item's height must be a finite number greater than zero.")}},r.prototype._isString=function(t){return"string"==typeof t||t instanceof String},r.prototype._isNumber=function(t){return"number"==typeof t||t instanceof Number},r.prototype._isIdentifierString=function(t){return!!this._isString(t)&&""!==t};var h=function(){function t(e,i,n,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._manager=e,this._question=i,this._items=n,this._footer=s}var e,i,n;return e=t,(i=[{key:"calcOptimalHeightForWidth",value:function(t){var e={width:e.width},i=2*this._manager.getSpacing();return this._question.setDimensions(e),i+=this._question.getHeight(),i+=this._items.calcOptimalHeightForWidth(t),this._footer.setDimensions(e),i+=this._footer.getHeight()}},{key:"calcOptimalDimForMaxDim",value:function(t){var e=this._items.calcOptimalWidth();e>t.width&&(e=t.width);var i={width:e},n=2*this._manager.getSpacing();this._question.setDimensions(i),n+=this._question.getHeight(),this._footer.setDimensions(i),n+=this._footer.getHeight();var s=this._items.calcOptimalHeightForWidth(e)+n;return void 0!==t.height&&s>t.height&&(s=t.height),{width:e,height:s}}},{key:"calcParamsForDim",value:function(t){var e={width:t.width};this._question.setDimensions(e);var i=this._question.getHeight(),n={width:t.width};this._footer.setDimensions(n);var s,o,r=this._footer.getHeight(),a=this._manager.getSpacing(),h=i+r+2*a,d={width:t.width};return void 0!==t.height?(o=t.height,d.height=o-h,s=this._items.calcParamsForDimensions(d)):(o=(s=this._items.calcParamsForDimensions(d)).height+h,this._manager.doesInnerHeightExceedLimit(o)&&(o=this._manager.getMaxInnerHeight(),d.height=o-h,s=this._items.calcParamsForDimensions(d))),{width:t.width,height:o,_height:o,spacing:a,questionDim:e,questionHeight:i,itemsParams:s,footerDim:n,footerHeight:r,itemsScale:s.scale,isTooSmallForTouch:s.isTooSmallForTouch,isLayoutImpossible:s.isLayoutImpossible,layoutErrorMessage:s.layoutErrorMessage}}},{key:"doLayoutWithParams",value:function(t){var e={x:t.x,y:t.y};void 0===e.x&&(e.x=0),void 0===e.y&&(e.y=0),t.height>t._height&&(e.y+=.5*(t.height-t._height)),this._question.setDimensions(t.questionDim),this._question.setPosition(e),e.y+=t.questionHeight+t.spacing,this._items.doLayoutWithParams(t.itemsParams),this._items.setPosition(e),e.y+=t.itemsParams.height+t.spacing,this._footer.setDimensions(t.footerDim),this._footer.setPosition(e)}}])&&a(e.prototype,i),n&&a(e,n),t}();function d(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var c=function(){function t(e,i,n,s){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._manager=e,this._QIFGroup=new h(e,i,n,s)}var e,i,n;return e=t,(i=[{key:"doLayout",value:function(){var t={width:this._manager.getInnerWidth()},e=this._QIFGroup.calcParamsForDim(t);this._manager.setInnerHeight(e.height);var i=this._manager.getInnerWidth();if(i!==t.width){var n=t.width,s=e;t.width=i,e=this._QIFGroup.calcParamsForDim(t),this._manager.setInnerHeight(e.height),(i=this._manager.getInnerWidth())!==t.width&&(t.width=Math.min(t.width,n),t.height=Math.max(s.height,e.height),e=this._QIFGroup.calcParamsForDim(t),this._manager.setInnerHeight(e.height))}e.x=0,e.y=0;var o=2*(this._manager.getSpacing()+this._manager.getBorderWidth());e.height+o<this._manager.getRootHeight()-1.1&&(e.height=this._manager.getRootHeight()-o,this._manager.setInnerHeight(e.height)),this._QIFGroup.doLayoutWithParams(e)}}])&&d(e.prototype,i),n&&d(e,n),t}();function l(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var _=function(){function t(e,i,n,s,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._manager=e,this._question=i,this._media=n,this._items=s,this._footer=o}var e,i,n;return e=t,(i=[{key:"calcParamsForDim",value:function(t){var e={width:t.width};this._question.setDimensions(e);var i={width:t.width};this._footer.setDimensions(i);var n,s,o,r=this._manager.getSpacing(),a=this._question.getHeight()+this._footer.getHeight()+3*r,h={width:t.width},d={width:t.width};if(void 0!==t.height){var c=(o=t.height)-a,l=this._calcMediaAndItemsParamsForCombinedHeight(c,h,d);n=l.mediaParams,s=l.itemsParams}else if(n=this._media.calcParamsForDimensions(h),o=(s=this._items.calcParamsForDimensions(d)).height+n.height+a,this._manager.doesInnerHeightExceedLimit(o)){var _=(o=this._manager.getMaxInnerHeight())-a,m=this._calcMediaAndItemsParamsForCombinedHeight(_,h,d);n=m.mediaParams,s=m.itemsParams}var u={width:t.width,height:o,spacing:r,questionDim:e,mediaParams:n,itemsParams:s,footerDim:i,avgScale:.5*(n.scale+s.scale),isTooSmallForTouch:n.isTooSmallForTouch||s.isTooSmallForTouch,isLayoutImpossible:!1};return s.isLayoutImpossible?(u.isLayoutImpossible=!0,u.layoutErrorMessage=s.layoutErrorMessage):n.isLayoutImpossible&&(u.isLayoutImpossible=!0,u.layoutErrorMessage=n.layoutErrorMessage),u}},{key:"doLayoutWithParams",value:function(t){var e={x:t.x,y:t.y};void 0===e.x&&(e.x=0),void 0===e.y&&(e.y=0),this._question.setDimensions(t.questionDim),this._question.setPosition(e),e.y+=this._question.getHeight()+t.spacing,this._media.doLayoutWithParams(t.mediaParams),this._media.setPosition(e),e.y+=this._media.getHeight()+t.spacing,this._items.doLayoutWithParams(t.itemsParams),this._items.setPosition(e),e.y+=this._items.getHeight()+t.spacing,this._footer.setDimensions(t.footerDim),this._footer.setPosition(e),e.y+=this._footer.getHeight()}},{key:"_calcMediaAndItemsParamsForCombinedHeight",value:function(t,e,i){var n,s,o=this._media.calcOptimalHeightForWidth(e.width),r=this._items.calcOptimalHeightForWidth(i.width),a=o+r;if(a<=t)e.height=t*(o/a),i.height=t*(r/a),n=this._media.calcParamsForDimensions(e),s=this._items.calcParamsForDimensions(i);else for(var h=1-r/t,d=o/t-h,c=h+.5*d,l=.25*d,_=Math.ceil(Math.log(t)/Math.LN2);_>0;--_){if(e.height=c*t,i.height=(1-c)*t,n=this._media.calcParamsForDimensions(e),s=this._items.calcParamsForDimensions(i),n.scale<s.scale)c+=l;else{if(!(n.scale>s.scale))break;c-=l}l*=.5}return{mediaParams:n,itemsParams:s}}}])&&l(e.prototype,i),n&&l(e,n),t}();function m(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var u=function(){function t(e,i,n,s,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._manager=e,this._QMIFGroup=new _(e,i,n,s,o)}var e,i,n;return e=t,(i=[{key:"calcParams",value:function(){var t={width:this._manager.getInnerWidth()},e=this._QMIFGroup.calcParamsForDim(t);this._manager.setInnerHeight(e.height);var i=this._manager.getInnerWidth();if(i!==t.width){var n=t.width,s=e;t.width=i,e=this._QMIFGroup.calcParamsForDim(t),this._manager.setInnerHeight(e.height),(i=this._manager.getInnerWidth())!==t.width&&(t.width=Math.min(t.width,n),t.height=Math.max(s.height,e.height),e=this._QMIFGroup.calcParamsForDim(t),this._manager.setInnerHeight(e.height))}e.x=0,e.y=0;var o=2*(this._manager.getSpacing()+this._manager.getBorderWidth());if(e.height+o<this._manager.getRootHeight()-1.1){var r=this._manager.getRootHeight()-o;e.y=.5*(r-e.height),e.height=r}return e}},{key:"doLayoutWithParams",value:function(t){this._manager.setInnerHeight(t.height),this._QMIFGroup.doLayoutWithParams(t)}}])&&m(e.prototype,i),n&&m(e,n),t}();function g(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var p=function(){function t(e,i,n,s,o){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._manager=e,this._media=n,this._QIFGroup=new h(e,i,s,o)}var e,i,n;return e=t,(i=[{key:"calcParams",value:function(){var t={width:this._manager.getInnerWidth()},e=this._calcParamsForDim(t);this._manager.setInnerHeight(e.height);var i=this._manager.getInnerWidth();if(i!==t.width){var n=t.width,s=e;t.width=i,e=this._calcParamsForDim(t),this._manager.setInnerHeight(e.height),(i=this._manager.getInnerWidth())!==t.width&&(t.width=Math.min(t.width,n),t.height=Math.max(s.height,e.height),e=this._calcParamsForDim(t),this._manager.setInnerHeight(e.height))}var o=2*(this._manager.getSpacing()+this._manager.getBorderWidth());return e.height+o<this._manager.getRootHeight()-1.1&&(e.height=this._manager.getRootHeight()-o,e.mediaPos.y=.5*(e.height-e.mediaParams.height),e.qifParams.y=.5*(e.height-e.qifParams.height)),e}},{key:"doLayoutWithParams",value:function(t){this._manager.setInnerHeight(t.height),this._media.doLayoutWithParams(t.mediaParams),this._media.setPosition(t.mediaPos),this._QIFGroup.doLayoutWithParams(t.qifParams)}},{key:"_calcParamsForDim",value:function(t){var e,i,n={},s={},o=this._manager.getSpacing(),r=t.width-o,a={width:r,height:t.height},h=this._media.calcOptimalDimForMaxDim(a);void 0===t.height&&this._manager.doesInnerHeightExceedLimit(h.height)&&(a.height=this._manager.getMaxInnerHeight(),h=this._media.calcOptimalDimForMaxDim(a));var d={width:r,height:t.height},c=this._QIFGroup.calcOptimalDimForMaxDim(d);void 0===t.height&&this._manager.doesInnerHeightExceedLimit(c.height)&&(d.height=this._manager.getMaxInnerHeight(),c=this._QIFGroup.calcOptimalDimForMaxDim(d));var l=h.width+c.width;if(l<=r)n.width=r*h.width/l,n.height=h.height,s.width=r*c.width/l,s.height=c.height,e=this._media.calcParamsForDimensions(n),i=this._QIFGroup.calcParamsForDim(s);else for(var _=1-c.width/r,m=h.width/r-_,u=_+.5*m,g=.25*m,p=Math.ceil(Math.log(r)/Math.LN2);p>0;--p){if(n.width=u*r,s.width=(1-u)*r,e=this._media.calcParamsForDimensions(n),this._manager.doesInnerHeightExceedLimit(e.height)&&(n.maxHeight=this._manager.getMaxInnerHeight(),e=this._media.calcParamsForDimensions(n)),i=this._QIFGroup.calcParamsForDim(s),e.scale<i.itemsScale)u+=g;else{if(!(e.scale>i.itemsScale))break;u-=g}g*=.5}i.x=e.width+o,i.y=0;var f={mediaParams:e,mediaPos:{x:0,y:0},qifParams:i};return f.height=Math.max(e.height,i.height),f.avgScale=.5*(e.scale+i.itemsScale),f.mediaParams.height=f.height,f.qifParams.height=f.height,f}}])&&g(e.prototype,i),n&&g(e,n),t}();function f(){this._element=document.createElement("div"),this._element.className="rt-question",this._elementWidth=void 0,this._elementHeight=void 0}f.prototype.getElement=function(){return this._element},f.prototype.setQuestion=function(t){this._element.textContent=t},f.prototype.setDimensions=function(t){t.width===this._elementWidth&&t.height===this._elementHeight||(this._element.style.width=t.width+"px",void 0!==t.height?this._element.style.height=t.height+"px":this._element.style.height=void 0,this._elementWidth=t.width,this._elementHeight=t.height)},f.prototype.getHeight=function(){return this._element.clientHeight},f.prototype.getDimensions=function(){return{width:this._element.clientWidth,height:this._element.clientHeight}},f.prototype.setPosition=function(t){this._element.style.left=t.x+"px",this._element.style.top=t.y+"px"};var v="http://www.w3.org/2000/svg";function y(t){this.parent=t,this._element=document.createElement("div"),this._element.className="rt-media",this._onImgLoad=this._onImgLoad.bind(this),this._onImgError=this._onImgError.bind(this),this._isReady=!1,this._isLabeledImage=!1}var b=y.prototype;function w(t,e){this.parent=t,this.root=this.parent.parent,this._def=e,this._element=document.createElement("div"),this._element.className="rt-item",this._element.tabIndex=0,this._imgContainer=document.createElement("div"),this._imgContainer.className="rt-item-img-container",this._element.appendChild(this._imgContainer),this._img=document.createElement("img"),this._img.className="rt-item-img",this._imgContainer.appendChild(this._img),void 0!==this._def.label?(this._label=document.createElement("div"),this._label.classList.add("rt-item-label"),this._label.textContent=this._def.label,this._element.appendChild(this._label)):this._label=void 0,this._touchID=void 0,this._backupTouches=[],this._onImgLoad=this._onImgLoad.bind(this),this._onFrame=this._onFrame.bind(this),this._onMouseDown=this._onMouseDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseFinished=this._onMouseFinished.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onTouchMove=this._onTouchMove.bind(this),this._onTouchFinished=this._onTouchFinished.bind(this),this._onFocus=this._onFocus.bind(this),this._onFocusOut=this._onFocusOut.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._dragOffsetX=0,this._width=1,this._halfWidth=1,this._height=1,this._halfHeight=1,this._maxHeight=1,this._halfMaxHeight=1,this._restX=0,this._centerX=0,this._centerY=0,this._isLocked=!0,this._areReviewDetailsShown=!1,this._DRAG_TYPE_NONE=0,this._DRAG_TYPE_MOUSE=1,this._DRAG_TYPE_TOUCH=2,this._dragType=this._DRAG_TYPE_NONE,this._frameRequestID=void 0,this._isReady=!1,this._img.addEventListener("load",this._onImgLoad),this._img.src=this.root._getExpandedURL(this._def.src)}b.setMedia=function(t){if(this.parent._removeChildren(this._element),this._isReady=!1,this._areItemsReady=!1,this._isImgReady=!1,"image"!==t.type&&"labeledImage"!==t.type)throw new Error("Unrecognized media type.");this._imgContainer=document.createElement("div"),this._imgContainer.className="rt-media-img-container",this._element.appendChild(this._imgContainer),this._img=document.createElement("img"),this._img.className="rt-media-img",this._unscaledImgWidth=t.width,this._unscaledImgHeight=t.height,this._img.addEventListener("load",this._onImgLoad),this._img.addEventListener("error",this._onImgError);var e=this.parent._getExpandedURL(t.src);this._img.src=e,this._labels=null,this._svg=null,this._itemSize=48,this._labelSize=.05,"labeledImage"===t.type?(this._isLabeledImage=!0,void 0!==t.itemSize&&(this._itemSize=t.itemSize),void 0!==t.labelSize&&(this._labelSize=t.labelSize)):this._isLabeledImage=!1},b.setItems=function(t){if(!this._isLabeledImage)throw new Error;var e=t.length,i=[{letter:"A",color:"#ff6666"},{letter:"B",color:"#66ff66"},{letter:"C",color:"#6666ff"},{letter:"D",color:"#ffb266"},{letter:"E",color:"#cc99ff"},{letter:"F",color:"#66ffff"},{letter:"G",color:"#c0c0c0"}];if(e>i.length)throw new Error("The labeled media image does not support this many labels.");this._labels=this.parent._shuffle(i.slice(0,e));for(var n=0;n<e;++n)t[n].___letter=this._labels[n].letter,t[n].___color=this._labels[n].color,t[n].___itemSize=this._itemSize,this._labels[n].x=t[n].x,this._labels[n].y=t[n].y;this._areItemsReady=!0,this._addImageLabels()},b._addImageLabels=function(){if(this._isLabeledImage&&this._areItemsReady&&this._isImgReady){this._svg=document.createElementNS(v,"svg"),this._svg.classList.add("rt-media-img"),this._imgContainer.appendChild(this._svg);var t=this._unscaledImgWidth,e=this._unscaledImgHeight,i=t*this._labelSize,n=.5*i;this._svg.setAttribute("viewBox","0 0 "+t+" "+e);var s=!0,o=!1,r=void 0;try{for(var a,h=this._labels[Symbol.iterator]();!(s=(a=h.next()).done);s=!0){var d=a.value;console.log(d),console.log("label.x: "+d.x),console.log("r: "+n),console.log("w: "+t);var c=t*d.x,l=e*(1-d.y),_=document.createElementNS(v,"circle");_.setAttribute("r",n),_.setAttribute("cx",c),_.setAttribute("cy",l),_.setAttribute("fill",d.color),this._svg.appendChild(_);var m=document.createElementNS(v,"text");m.setAttribute("x",c),m.setAttribute("y",l),m.setAttribute("fill","#ffffff"),m.setAttribute("style","font: bold "+.7*i+"px sans-serif; user-select: none;"),m.setAttribute("text-anchor","middle"),m.setAttribute("dominant-baseline","central"),m.textContent=d.letter,this._svg.appendChild(m)}}catch(t){o=!0,r=t}finally{try{s||null==h.return||h.return()}finally{if(o)throw r}}}},b._onImgError=function(t){this.parent._reportWarning("Error loading media image."),console.warn(t)},b._onImgLoad=function(t){var e=!1,i=!1;void 0===this._unscaledImgWidth&&(this._unscaledImgWidth=this._img.width,e=!0),void 0===this._unscaledImgHeight&&(this._unscaledImgHeight=this._img.height,i=!0),this._imgContainer.appendChild(this._img),null!==this._svg&&this._imgContainer.appendChild(this._svg),e&&!i?this.parent._reportWarning("Potentially inconsistent dimensions for the media image. The height is specified in the definition, but the width is not."):!e&&i&&this.parent._reportWarning("Potentially inconsistent dimensions for the media image. The width is specified in the definition, but the height is not."),this._isReady=!0,this._isImgReady=!0,this._addImageLabels(),this.parent._onMediaReady()},b.getIsReady=function(){return this._isReady},b.getElement=function(){return this._element},b.calcOptimalDimForMaxDim=function(t){var e,i=t.width/this._unscaledImgWidth;if(void 0!==t.height){var n=t.height/this._unscaledImgHeight;e=Math.min(i,n)}else e=i;return{width:(e=this._enforceScaleLimits(e))*this._unscaledImgWidth,height:e*this._unscaledImgHeight}},b.calcOptimalHeightForWidth=function(t){if(!this._isReady)throw new Error("The media block's calcOptimalHeightForWidth called when it was not ready.");var e=t/this._unscaledImgWidth;return(e=this._enforceScaleLimits(e))*this._unscaledImgHeight},b._enforceScaleLimits=function(t){return t>1?1:t},b.calcParamsForDimensions=function(t){if(!this._isReady)throw new Error("The media block's calcParamsForDimensions called when it was not ready.");var e,i=t.width/this._unscaledImgWidth;if(void 0!==t.height){var n=t.height/this._unscaledImgHeight;e=Math.min(i,n)}else if(void 0!==t.maxHeight){var s=t.maxHeight/this._unscaledImgHeight;e=Math.min(i,s)}else e=i;var o={scale:e=this._enforceScaleLimits(e),width:t.width,isTooSmallForTouch:!1,isLayoutImpossible:!1};return void 0!==t.height?o.height=t.height:o.height=e*this._unscaledImgHeight,(Number.isNaN(e)||!Number.isFinite(e)||e<=0)&&(o.isLayoutImpossible=!0,o.layoutErrorMessage="The scale calculated for the media block is invalid."),o},b.doLayoutWithParams=function(t){if(!this._isReady)throw new Error("The media block's doLayoutWithParams called when it was not ready.");if(t.isLayoutImpossible)throw new Error(t.layoutErrorMessage);t.isTooSmallForTouch&&this.parent._reportWarning("The media object may be too small for reliable touch interaction."),this._element.style.width=t.width+"px",void 0!==t.height?this._element.style.height=t.height+"px":this._element.style.height=void 0;var e=t.scale*this._unscaledImgWidth,i=t.scale*this._unscaledImgHeight;this._imgContainer.style.width=e+"px",this._imgContainer.style.height=i+"px",this._imgContainer.style.left=.5*(t.width-e)+"px",void 0!==t.height?this._imgContainer.style.top=.5*(t.height-i)+"px":this._imgContainer.style.top="0px"},b.setDimensions=function(t){if(!this._isReady)throw new Error("The media block's setDimensions called when it is not ready.");var e=this.calcParamsForDimensions(t);return this.doLayoutWithParams(e),e},b.setPosition=function(t){this._element.style.left=t.x+"px",this._element.style.top=t.y+"px"},b.getHeight=function(){return this._element.clientHeight},w.prototype.getIsReady=function(){return this._isReady},w.prototype.getElement=function(){return this._element},w.prototype.getDefinition=function(){return this._def},w.prototype.getIsAtRest=function(){return this._restX===this._centerX},w.prototype.getIsBeingDragged=function(){return this._dragType!==this._DRAG_TYPE_NONE&&(this._dragType===this._DRAG_TYPE_MOUSE||this._dragType===this._DRAG_TYPE_TOUCH||(this.root._reportWarning("Invalid dragType in getIsBeingDragged."),!1))},w.prototype.getIsAnimating=function(){return void 0!==this._frameRequestID},w.prototype.getIsLocked=function(){return this._isLocked},w.prototype.getUnscaledDimensions=function(){return{width:this._unscaledWidth,height:this._unscaledHeight}},w.prototype.setScaleAndMaxHeight=function(t,e){if(this._width=t*this._unscaledWidth,this._halfWidth=.5*this._width,this._height=t*this._unscaledHeight,this._halfHeight=.5*this._height,this._maxHeight=e,this._halfMaxHeight=.5*e,this._element.style.width=this._width+"px",this._element.style.height=this._maxHeight+"px",this._imgContainer.style.width=this._width+"px",this._imgContainer.style.height=this._height+"px",this._imgContainer.style.top=.5*(e-this._height)+"px",void 0!==this._label){this._label.maxWidth=.75*this._width+"px",this._label.style.left=this._halfWidth+"px";var i=this._label.getBoundingClientRect();this._label.style.top=this._maxHeight-i.height+"px"}this._layoutReviewDetails()},w.prototype.getHalfWidth=function(){return this._halfWidth},w.prototype._layoutReviewDetails=function(){this._areReviewDetailsShown&&(this._reviewContainer.style.left=this._halfWidth+"px",this._reviewContainer.style.top="0px")},w.prototype._onImgLoad=function(t){this._unscaledWidth=this._def.width,void 0===this._unscaledWidth&&(this._unscaledWidth=this._img.width),this._unscaledHeight=this._def.height,void 0===this._unscaledHeight&&(this._unscaledHeight=this._img.height),this._isReady=!0,this.parent._onItemReady(this),this._img.removeEventListener("load",this._onImgLoad)},w.prototype.snapToRest=function(){this._stopDrag(),this._stopAnimating(),this.setX(this._restX)},w.prototype.animateToRest=function(){this._stopDrag(),this.getIsAnimating()||this._startAnimating()},w.prototype.getRestX=function(){return this._restX},w.prototype.setRestX=function(t,e){this._restX=this._limitPrecision(t),this.getIsBeingDragged()||(e?this._startAnimating():this.snapToRest())},w.prototype.getX=function(){return this._centerX},w.prototype.setX=function(t){var e=this.parent.getDragLimits();t<e.min+this._halfWidth?t=e.min+this._halfWidth:t>e.max-this._halfWidth&&(t=e.max-this._halfWidth),this._centerX=this._limitPrecision(t),this._element.style.left=this._centerX-this._halfWidth+"px"},w.prototype.getY=function(){return this._centerY},w.prototype.setY=function(t){this._centerY=t,this._element.style.top=t-this._halfMaxHeight+"px"},w.prototype._limitPrecision=function(t){return Math.round(100*t)/100},w.prototype.setIsLocked=function(t,e){t?this.lock(e):this.unlock()},w.prototype.unlock=function(){this._isLocked&&(this._isLocked=!1,this._element.classList.remove("rt-normal-cursor"),this._element.classList.add("rt-grab-cursor"),this._element.addEventListener("mousedown",this._onMouseDown),this._element.addEventListener("touchstart",this._onTouchStart),this._element.addEventListener("focus",this._onFocus),this._element.addEventListener("focusout",this._onFocusOut),this._element.addEventListener("keydown",this._onKeyDown),this._element.tabIndex=0)},w.prototype.lock=function(t){this._isLocked||(this._isLocked=!0,this._element.classList.remove("rt-grab-cursor"),this._element.classList.add("rt-normal-cursor"),this._element.removeEventListener("mousedown",this._onMouseDown),this._element.removeEventListener("touchstart",this._onTouchStart),this._element.removeEventListener("focus",this._onFocus),this._element.removeEventListener("focusout",this._onFocusOut),this._element.removeEventListener("keydown",this._onKeyDown),this._element.removeAttribute("tabIndex"),t?this.animateToRest():this.snapToRest())},w.prototype._onFocus=function(t){this.parent._bringToFront(this),this.parent._registerFocusedItem(this)},w.prototype._onFocusOut=function(t){this.parent._unregisterFocusedItem(this)},w.prototype._onKeyDown=function(t){"ArrowRight"===t.key?(t.preventDefault(),this._stopDrag(),this.parent._shiftItemRight(this)):"ArrowLeft"===t.key&&(t.preventDefault(),this._stopDrag(),this.parent._shiftItemLeft(this))},w.prototype.setAreReviewDetailsShown=function(t){t?this.showReviewDetails():this.hideReviewDetails()},w.prototype.showReviewDetails=function(){if(!this._areReviewDetailsShown)if(void 0!==this._def.order||void 0!==this._def.feedback){void 0===this._def.order&&this.root._reportWarning("showReviewDetails called for an item with no order property.");var t=this._def.isCorrect;void 0===this._def.isCorrect&&(t=!0,this.root._reportWarning("showReviewDetails called for an item with no isCorrect property.")),this._areReviewDetailsShown=!0,this._reviewContainer=document.createElement("div"),this._reviewContainer.className="rt-item-review-container",this._reviewContainer.style.borderColor=t?"black":"red",void 0!==this._def.order?(this._order=document.createElement("div"),this._order.className="rt-item-review-order",this._order.textContent=this._def.order,this._order.style.color=t?"black":"red",this._reviewContainer.appendChild(this._order)):this._order=void 0,void 0!==this._def.feedback?(this._feedback=document.createElement("div"),this._feedback.className="rt-item-review-feedback",this._feedback.textContent=this._def.feedback,this._reviewContainer.appendChild(this._feedback)):this._feedback=void 0,this._element.appendChild(this._reviewContainer),this._layoutReviewDetails()}else this.root._reportWarning("showReviewDetails called for an item with no order and feedback properties.")},w.prototype.hideReviewDetails=function(){this._areReviewDetailsShown&&(this._areReviewDetailsShown=!1,this._element.removeChild(this._reviewContainer),this._reviewContainer=void 0,this._order=void 0,this._feedback=void 0)},w.prototype._startDrag=function(t,e){if(this._isLocked)return console.error("startDrag called when the item is locked."),!1;if(this.getIsBeingDragged())return!1;if(e===this._DRAG_TYPE_MOUSE)this._grabbingLayer=document.createElement("div"),this._grabbingLayer.className="rt-grabbing-layer",document.body.appendChild(this._grabbingLayer),document.addEventListener("mousemove",this._onMouseMove),document.addEventListener("mouseup",this._onMouseFinished),document.addEventListener("mouseleave",this._onMouseFinished);else{if(e!=this._DRAG_TYPE_TOUCH)return console.error("Invalid dragType in startDrag."),!1;document.addEventListener("touchmove",this._onTouchMove),document.addEventListener("touchend",this._onTouchFinished),document.addEventListener("touchcancel",this._onTouchFinished)}return this._dragType=e,this._stopAnimating(),this.parent._bringToFront(this),this._calcOffset(t),!0},w.prototype._updateDrag=function(t){if(this.getIsBeingDragged()){var e=this.parent.getXFromClientX(t)-this._dragOffsetX;this.setX(e),this.parent._onDragUpdate(this)}else console.error("updateDrag called for an item that is not being dragged.")},w.prototype._calcOffset=function(t){this.getIsBeingDragged()?this._dragOffsetX=this.parent.getXFromClientX(t)-this._centerX:console.error("resetDrag called for an item that is not being dragged.")},w.prototype._stopDrag=function(){this._dragType===this._DRAG_TYPE_MOUSE?(document.body.removeChild(this._grabbingLayer),this._grabbingLayer=void 0,document.removeEventListener("mousemove",this._onMouseMove),document.removeEventListener("mouseup",this._onMouseFinished),document.removeEventListener("mouseleave",this._onMouseFinished)):this._dragType===this._DRAG_TYPE_TOUCH&&(document.removeEventListener("touchmove",this._onTouchMove),document.removeEventListener("touchend",this._onTouchFinished),document.removeEventListener("touchcancel",this._onTouchFinished)),this._dragType=this._DRAG_TYPE_NONE},w.prototype._startAnimating=function(){this.getIsBeingDragged()||this.getIsAtRest()||(this._animStartTime=void 0,void 0===this._frameRequestID&&this._requestFrame())},w.prototype._stopAnimating=function(){void 0!==this._frameRequestID&&(window.cancelAnimationFrame(this._frameRequestID),this._frameRequestID=void 0)},w.prototype._requestFrame=function(){this._frameRequestID=window.requestAnimationFrame(this._onFrame)},w.prototype._onFrame=function(t){void 0===this._animStartTime&&(this._animStartTime=t,this._animM=this._restX-this._centerX,this._animB=this._centerX,this._animDuration=this._getAnimDuration(this._animM));var e=(t-this._animStartTime)/this._animDuration;e>1&&(e=1);var i=e*this._animM+this._animB;this.setX(i),e<1?this._requestFrame():this._frameRequestID=void 0},w.prototype._getAnimDuration=function(t){var e=100+200*Math.abs(t)/(.5*this.parent.getDragRange());return Math.min(200,Math.max(100,e))},w.prototype._onMouseDown=function(t){this._startDrag(t.clientX,this._DRAG_TYPE_MOUSE)&&(t.preventDefault(),this._element.focus())},w.prototype._onMouseMove=function(t){t.preventDefault(),this._updateDrag(t.clientX)},w.prototype._onMouseFinished=function(t){t.preventDefault(),this.animateToRest()},w.prototype._onTouchStart=function(t){if(this._dragType===this._DRAG_TYPE_TOUCH)return t.preventDefault(),void this._startTrackingBackupTouches(t.changedTouches);this._backupTouches=[],this._startTrackingBackupTouches(t.changedTouches);var e=this._selectBackupTouch();if(void 0===e){this.root._reportWarning("Unexpected failure to select an active touch."),(e={}).id=t.changedTouches[0].identifier,e.x=t.changedTouches[0].clientX;var i=Array.from(t.changedTouches).slice(1);this._backupTouches=[],this._startTrackingBackupTouches(i)}this._startDrag(e.x,this._DRAG_TYPE_TOUCH)&&(t.preventDefault(),this._touchID=e.id)},w.prototype._onTouchMove=function(t){this._updateAnyBackupTouches(t.changedTouches);var e=this._getActiveTouch(t);void 0!==e&&(t.preventDefault(),this._updateDrag(e.clientX))},w.prototype._onTouchFinished=function(t){if(this._stopTrackingAnyBackupTouches(t.changedTouches),void 0!==this._getActiveTouch(t)){var e=this._selectBackupTouch();void 0!==e?(this._touchID=e.id,this._calcOffset(e.x)):this.animateToRest()}},w.prototype._getActiveTouch=function(t){if(void 0!==this._touchID)for(var e=0;e<t.changedTouches.length;++e){var i=t.changedTouches[e];if(i.identifier===this._touchID)return i}else this.root._reportWarning("getActiveTouch called for item with no active touch (event: "+t.type+").")},w.prototype._startTrackingBackupTouches=function(t){for(var e=0;e<t.length;++e){var i=t[e];this._backupTouches.push({id:i.identifier,x:i.clientX,y:i.clientY})}},w.prototype._updateAnyBackupTouches=function(t){for(var e=0;e<this._backupTouches.length;++e)for(var i=this._backupTouches[e],n=0;n<t.length;++n){var s=t[n];if(s.identifier===i.id){i.x=s.clientX,i.y=s.clientY;break}}},w.prototype._stopTrackingAnyBackupTouches=function(t){for(var e=this._backupTouches.length-1;e>=0;--e)for(var i=this._backupTouches[e].id,n=0;n<t.length;++n)if(t[n].identifier===i){this._backupTouches.splice(e,1);break}},w.prototype._selectBackupTouch=function(){for(var t=1.1*this._halfWidth,e=this._centerX+t,i=this._centerX-t,n=1.1*this._halfHeight,s=this._centerY+n,o=this._centerY-n,r=this.parent.getPointsFromClientPoints(this._backupTouches),a=Number.POSITIVE_INFINITY,h=-1,d=void 0,c=0;c<this._backupTouches.length;++c){var l=r[c].x,_=r[c].y;if(!(l<i||l>e||_<o||_>s)){var m=l*l+_*_;m<a&&(a=m,h=c,d=this._backupTouches[c])}}return h>=0&&this._backupTouches.splice(h,1),d};function I(t,e){this.parent=t,this.root=this.parent.parent,this._def=e,this._element=document.createElement("div"),this._element.className="rt-item",this._element.tabIndex=0,this._unscaledHeight=this._unscaledWidth=this._def.___itemSize;var i=this._unscaledWidth,n=i/2;this._svg=document.createElementNS("http://www.w3.org/2000/svg","svg"),this._svg.setAttribute("viewBox","0 0 "+i+" "+i),this._svg.classList.add("rt-item-img"),this._discAndLetter=document.createElementNS("http://www.w3.org/2000/svg","g"),this._svg.appendChild(this._discAndLetter),this._disc=document.createElementNS("http://www.w3.org/2000/svg","circle"),this._disc.setAttribute("r",n),this._disc.setAttribute("cx",n),this._disc.setAttribute("cy",n),this._disc.setAttribute("fill",this._def.___color),this._discAndLetter.appendChild(this._disc),this._letter=document.createElementNS("http://www.w3.org/2000/svg","text"),this._letter.setAttribute("x",n),this._letter.setAttribute("y",n),this._letter.setAttribute("fill","#ffffff"),this._letter.setAttribute("style","font: bold "+.7*i+"px sans-serif;"),this._letter.setAttribute("text-anchor","middle"),this._letter.setAttribute("dominant-baseline","central"),this._letter.textContent=this._def.___letter,this._discAndLetter.appendChild(this._letter),this._imgContainer=document.createElement("div"),this._imgContainer.className="rt-item-img-container",this._element.appendChild(this._imgContainer),this._imgContainer.appendChild(this._svg),void 0!==this._def.label?(this._label=document.createElement("div"),this._label.classList.add("rt-item-label"),this._label.textContent=this._def.label,this._element.appendChild(this._label)):this._label=void 0,this._touchID=void 0,this._backupTouches=[],this._onFrame=this._onFrame.bind(this),this._onMouseDown=this._onMouseDown.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseFinished=this._onMouseFinished.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onTouchMove=this._onTouchMove.bind(this),this._onTouchFinished=this._onTouchFinished.bind(this),this._onFocus=this._onFocus.bind(this),this._onFocusOut=this._onFocusOut.bind(this),this._onKeyDown=this._onKeyDown.bind(this),this._dragOffsetX=0,this._width=1,this._halfWidth=1,this._height=1,this._halfHeight=1,this._maxHeight=1,this._halfMaxHeight=1,this._restX=0,this._centerX=0,this._centerY=0,this._isLocked=!0,this._areReviewDetailsShown=!1,this._DRAG_TYPE_NONE=0,this._DRAG_TYPE_MOUSE=1,this._DRAG_TYPE_TOUCH=2,this._dragType=this._DRAG_TYPE_NONE,this._frameRequestID=void 0,this._isReady=!0}function E(t){this.parent=t,this._items=[],this._isReady=!1,this._isLocked=!0,this._areReviewDetailsShown=!1,this._element=document.createElement("div"),this._element.classList.add("rt-items"),this._dragMin=0,this._dragMax=0,this._itemsStartX=0,this._itemsEndX=0,this._itemSpacing=10,this._nudgeDistance=10,this._maxScale=1,this._safeDragMarginExtra=6}function D(t){var e=this;this.parent=t,this._element=document.createElement("div"),this._element.className="rt-footer";var i=document.createElement("div");i.className="rt-footer-left",this._element.appendChild(i);var n=document.createElement("div");n.className="rt-footer-center",this._element.appendChild(n);var s=document.createElement("div");s.className="rt-footer-right",this._element.appendChild(s),this._feedback=document.createElement("div"),this._feedback.className="rt-feedback",this._feedback.textContent=".",n.appendChild(this._feedback),this._actionButton=document.createElement("button"),this._actionButton.className="rt-action-button",this._actionButton.type="button",s.appendChild(this._actionButton),this._backgroundButton=document.createElement("button"),this._backgroundButton.className="rt-background-button",this._backgroundButton.type="button",this._backgroundButton.name="Background",this._backgroundButton.textContent="Background",i.appendChild(this._backgroundButton),this._backgroundButton.addEventListener("click",(function(t){e.parent._onBackgroundButtonClick()})),this._actionButton.addEventListener("click",(function(t){e.parent._onActionButtonClick()})),this._actionButtonIsVisible=!0,this._backgroundButtonIsVisible=!0,this._elementWidth=void 0,this._elementHeight=void 0}function T(t,e){if(this._MODE_ERROR=-1,this._MODE_UNDEFINED=0,this._MODE_ACTIVE_GRADABLE=1,this._MODE_ACTIVE_NOT_GRADABLE=2,this._MODE_REVIEW_RESETTABLE=3,this._MODE_REVIEW_NOT_RESETTABLE=4,this._MIN_TOUCH_THRESHOLD=30,null==t)throw new Error("The RankingTask constructor requires a valid root element argument.");this._rootElement=t,this._rootElement.classList.add("rt-root"),this._rootStyle=window.getComputedStyle(this._rootElement),this._debugName=void 0!==e?e:"unspecified",this._isInitialized=!1,this._isDoingLayoutReset=!1,this._mode=this._MODE_UNDEFINED,this._savedRootBackgroundColor=void 0}I.prototype.getIsReady=function(){return this._isReady},I.prototype.getElement=function(){return this._element},I.prototype.getDefinition=function(){return this._def},I.prototype.getIsAtRest=function(){return this._restX===this._centerX},I.prototype.getIsBeingDragged=function(){return this._dragType!==this._DRAG_TYPE_NONE&&(this._dragType===this._DRAG_TYPE_MOUSE||this._dragType===this._DRAG_TYPE_TOUCH||(this.root._reportWarning("Invalid dragType in getIsBeingDragged."),!1))},I.prototype.getIsAnimating=function(){return void 0!==this._frameRequestID},I.prototype.getIsLocked=function(){return this._isLocked},I.prototype.getUnscaledDimensions=function(){return{width:this._unscaledWidth,height:this._unscaledHeight}},I.prototype.setScaleAndMaxHeight=function(t,e){if(this._width=t*this._unscaledWidth,this._halfWidth=.5*this._width,this._height=t*this._unscaledHeight,this._halfHeight=.5*this._height,this._maxHeight=e,this._halfMaxHeight=.5*e,this._element.style.width=this._width+"px",this._element.style.height=this._maxHeight+"px",this._imgContainer.style.width=this._width+"px",this._imgContainer.style.height=this._height+"px",this._imgContainer.style.top=.5*(e-this._height)+"px",void 0!==this._label){this._label.maxWidth=.75*this._width+"px",this._label.style.left=this._halfWidth+"px";var i=this._label.getBoundingClientRect();this._label.style.top=this._maxHeight-i.height+"px"}this._layoutReviewDetails()},I.prototype.getHalfWidth=function(){return this._halfWidth},I.prototype._layoutReviewDetails=function(){this._areReviewDetailsShown&&(this._reviewContainer.style.left=this._halfWidth+"px",this._reviewContainer.style.top="0px")},I.prototype.snapToRest=function(){this._stopDrag(),this._stopAnimating(),this.setX(this._restX)},I.prototype.animateToRest=function(){this._stopDrag(),this.getIsAnimating()||this._startAnimating()},I.prototype.getRestX=function(){return this._restX},I.prototype.setRestX=function(t,e){this._restX=this._limitPrecision(t),this.getIsBeingDragged()||(e?this._startAnimating():this.snapToRest())},I.prototype.getX=function(){return this._centerX},I.prototype.setX=function(t){var e=this.parent.getDragLimits();t<e.min+this._halfWidth?t=e.min+this._halfWidth:t>e.max-this._halfWidth&&(t=e.max-this._halfWidth),this._centerX=this._limitPrecision(t),this._element.style.left=this._centerX-this._halfWidth+"px"},I.prototype.getY=function(){return this._centerY},I.prototype.setY=function(t){this._centerY=t,this._element.style.top=t-this._halfMaxHeight+"px"},I.prototype._limitPrecision=function(t){return Math.round(100*t)/100},I.prototype.setIsLocked=function(t,e){t?this.lock(e):this.unlock()},I.prototype.unlock=function(){this._isLocked&&(this._isLocked=!1,this._element.classList.remove("rt-normal-cursor"),this._element.classList.add("rt-grab-cursor"),this._element.addEventListener("mousedown",this._onMouseDown),this._element.addEventListener("touchstart",this._onTouchStart),this._element.addEventListener("focus",this._onFocus),this._element.addEventListener("focusout",this._onFocusOut),this._element.addEventListener("keydown",this._onKeyDown),this._element.tabIndex=0)},I.prototype.lock=function(t){this._isLocked||(this._isLocked=!0,this._element.classList.remove("rt-grab-cursor"),this._element.classList.add("rt-normal-cursor"),this._element.removeEventListener("mousedown",this._onMouseDown),this._element.removeEventListener("touchstart",this._onTouchStart),this._element.removeEventListener("focus",this._onFocus),this._element.removeEventListener("focusout",this._onFocusOut),this._element.removeEventListener("keydown",this._onKeyDown),this._element.removeAttribute("tabIndex"),t?this.animateToRest():this.snapToRest())},I.prototype._onFocus=function(t){this.parent._bringToFront(this),this.parent._registerFocusedItem(this)},I.prototype._onFocusOut=function(t){this.parent._unregisterFocusedItem(this)},I.prototype._onKeyDown=function(t){"ArrowRight"===t.key?(t.preventDefault(),this._stopDrag(),this.parent._shiftItemRight(this)):"ArrowLeft"===t.key&&(t.preventDefault(),this._stopDrag(),this.parent._shiftItemLeft(this))},I.prototype.setAreReviewDetailsShown=function(t){t?this.showReviewDetails():this.hideReviewDetails()},I.prototype.showReviewDetails=function(){if(!this._areReviewDetailsShown)if(void 0!==this._def.order||void 0!==this._def.feedback){void 0===this._def.order&&this.root._reportWarning("showReviewDetails called for an item with no order property.");var t=this._def.isCorrect;void 0===this._def.isCorrect&&(t=!0,this.root._reportWarning("showReviewDetails called for an item with no isCorrect property.")),this._areReviewDetailsShown=!0,this._reviewContainer=document.createElement("div"),this._reviewContainer.className="rt-item-review-container",this._reviewContainer.style.borderColor=t?"black":"red",void 0!==this._def.order?(this._order=document.createElement("div"),this._order.className="rt-item-review-order",this._order.textContent=this._def.order,this._order.style.color=t?"black":"red",this._reviewContainer.appendChild(this._order)):this._order=void 0,void 0!==this._def.feedback?(this._feedback=document.createElement("div"),this._feedback.className="rt-item-review-feedback",this._feedback.textContent=this._def.feedback,this._reviewContainer.appendChild(this._feedback)):this._feedback=void 0,this._element.appendChild(this._reviewContainer),this._layoutReviewDetails()}else this.root._reportWarning("showReviewDetails called for an item with no order and feedback properties.")},I.prototype.hideReviewDetails=function(){this._areReviewDetailsShown&&(this._areReviewDetailsShown=!1,this._element.removeChild(this._reviewContainer),this._reviewContainer=void 0,this._order=void 0,this._feedback=void 0)},I.prototype._startDrag=function(t,e){if(this._isLocked)return console.error("startDrag called when the item is locked."),!1;if(this.getIsBeingDragged())return!1;if(e===this._DRAG_TYPE_MOUSE)this._grabbingLayer=document.createElement("div"),this._grabbingLayer.className="rt-grabbing-layer",document.body.appendChild(this._grabbingLayer),document.addEventListener("mousemove",this._onMouseMove),document.addEventListener("mouseup",this._onMouseFinished),document.addEventListener("mouseleave",this._onMouseFinished);else{if(e!=this._DRAG_TYPE_TOUCH)return console.error("Invalid dragType in startDrag."),!1;document.addEventListener("touchmove",this._onTouchMove),document.addEventListener("touchend",this._onTouchFinished),document.addEventListener("touchcancel",this._onTouchFinished)}return this._dragType=e,this._stopAnimating(),this.parent._bringToFront(this),this._calcOffset(t),!0},I.prototype._updateDrag=function(t){if(this.getIsBeingDragged()){var e=this.parent.getXFromClientX(t)-this._dragOffsetX;this.setX(e),this.parent._onDragUpdate(this)}else console.error("updateDrag called for an item that is not being dragged.")},I.prototype._calcOffset=function(t){this.getIsBeingDragged()?this._dragOffsetX=this.parent.getXFromClientX(t)-this._centerX:console.error("resetDrag called for an item that is not being dragged.")},I.prototype._stopDrag=function(){this._dragType===this._DRAG_TYPE_MOUSE?(document.body.removeChild(this._grabbingLayer),this._grabbingLayer=void 0,document.removeEventListener("mousemove",this._onMouseMove),document.removeEventListener("mouseup",this._onMouseFinished),document.removeEventListener("mouseleave",this._onMouseFinished)):this._dragType===this._DRAG_TYPE_TOUCH&&(document.removeEventListener("touchmove",this._onTouchMove),document.removeEventListener("touchend",this._onTouchFinished),document.removeEventListener("touchcancel",this._onTouchFinished)),this._dragType=this._DRAG_TYPE_NONE},I.prototype._startAnimating=function(){this.getIsBeingDragged()||this.getIsAtRest()||(this._animStartTime=void 0,void 0===this._frameRequestID&&this._requestFrame())},I.prototype._stopAnimating=function(){void 0!==this._frameRequestID&&(window.cancelAnimationFrame(this._frameRequestID),this._frameRequestID=void 0)},I.prototype._requestFrame=function(){this._frameRequestID=window.requestAnimationFrame(this._onFrame)},I.prototype._onFrame=function(t){void 0===this._animStartTime&&(this._animStartTime=t,this._animM=this._restX-this._centerX,this._animB=this._centerX,this._animDuration=this._getAnimDuration(this._animM));var e=(t-this._animStartTime)/this._animDuration;e>1&&(e=1);var i=e*this._animM+this._animB;this.setX(i),e<1?this._requestFrame():this._frameRequestID=void 0},I.prototype._getAnimDuration=function(t){var e=100+200*Math.abs(t)/(.5*this.parent.getDragRange());return Math.min(200,Math.max(100,e))},I.prototype._onMouseDown=function(t){this._startDrag(t.clientX,this._DRAG_TYPE_MOUSE)&&(t.preventDefault(),this._element.focus())},I.prototype._onMouseMove=function(t){t.preventDefault(),this._updateDrag(t.clientX)},I.prototype._onMouseFinished=function(t){t.preventDefault(),this.animateToRest()},I.prototype._onTouchStart=function(t){if(this._dragType===this._DRAG_TYPE_TOUCH)return t.preventDefault(),void this._startTrackingBackupTouches(t.changedTouches);this._backupTouches=[],this._startTrackingBackupTouches(t.changedTouches);var e=this._selectBackupTouch();if(void 0===e){this.root._reportWarning("Unexpected failure to select an active touch."),(e={}).id=t.changedTouches[0].identifier,e.x=t.changedTouches[0].clientX;var i=Array.from(t.changedTouches).slice(1);this._backupTouches=[],this._startTrackingBackupTouches(i)}this._startDrag(e.x,this._DRAG_TYPE_TOUCH)&&(t.preventDefault(),this._touchID=e.id)},I.prototype._onTouchMove=function(t){this._updateAnyBackupTouches(t.changedTouches);var e=this._getActiveTouch(t);void 0!==e&&(t.preventDefault(),this._updateDrag(e.clientX))},I.prototype._onTouchFinished=function(t){if(this._stopTrackingAnyBackupTouches(t.changedTouches),void 0!==this._getActiveTouch(t)){var e=this._selectBackupTouch();void 0!==e?(this._touchID=e.id,this._calcOffset(e.x)):this.animateToRest()}},I.prototype._getActiveTouch=function(t){if(void 0!==this._touchID)for(var e=0;e<t.changedTouches.length;++e){var i=t.changedTouches[e];if(i.identifier===this._touchID)return i}else this.root._reportWarning("getActiveTouch called for item with no active touch (event: "+t.type+").")},I.prototype._startTrackingBackupTouches=function(t){for(var e=0;e<t.length;++e){var i=t[e];this._backupTouches.push({id:i.identifier,x:i.clientX,y:i.clientY})}},I.prototype._updateAnyBackupTouches=function(t){for(var e=0;e<this._backupTouches.length;++e)for(var i=this._backupTouches[e],n=0;n<t.length;++n){var s=t[n];if(s.identifier===i.id){i.x=s.clientX,i.y=s.clientY;break}}},I.prototype._stopTrackingAnyBackupTouches=function(t){for(var e=this._backupTouches.length-1;e>=0;--e)for(var i=this._backupTouches[e].id,n=0;n<t.length;++n)if(t[n].identifier===i){this._backupTouches.splice(e,1);break}},I.prototype._selectBackupTouch=function(){for(var t=1.1*this._halfWidth,e=this._centerX+t,i=this._centerX-t,n=1.1*this._halfHeight,s=this._centerY+n,o=this._centerY-n,r=this.parent.getPointsFromClientPoints(this._backupTouches),a=Number.POSITIVE_INFINITY,h=-1,d=void 0,c=0;c<this._backupTouches.length;++c){var l=r[c].x,_=r[c].y;if(!(l<i||l>e||_<o||_>s)){var m=l*l+_*_;m<a&&(a=m,h=c,d=this._backupTouches[c])}}return h>=0&&this._backupTouches.splice(h,1),d},E.prototype.getElement=function(){return this._element},E.prototype.getItems=function(){for(var t=[],e=0;e<this._items.length;++e)t.push(this._items[e].getDefinition());return t},E.prototype.setItems=function(t){if(this._isReady=!1,this._removeChildren(this._element),this._items=[],t.length<2)throw new Error("There must be at least two items.");for(var e=!1,i=0;i<t.length;++i){var n=t[i];if("image"===n.type){var s=new w(this,n);s.setIsLocked(this._isLocked,!1),s.setAreReviewDetailsShown(this._areReviewDetailsShown),this._items.push(s)}else{if("label"!==n.type)throw this._items=[],new Error("An item has an invalid type property.");e=!0;var o=new I(this,n);o.setIsLocked(this._isLocked,!1),o.setAreReviewDetailsShown(this._areReviewDetailsShown),this._items.push(o)}}e&&this._onItemReady(null)},E.prototype.getIsReady=function(){return this._isReady},E.prototype.setItemSpacing=function(t){this._itemSpacing=t,this._nudgeDistance=Math.max(this._itemSpacing,10)},E.prototype.lock=function(){this._unfocusItem();for(var t=0;t<this._items.length;++t)this._items[t].lock();this._isLocked=!0},E.prototype.unlock=function(){for(var t=0;t<this._items.length;++t)this._items[t].unlock();this._isLocked=!1},E.prototype.showReviewDetails=function(){for(var t=0;t<this._items.length;++t)this._items[t].showReviewDetails();this._areReviewDetailsShown=!0},E.prototype.hideReviewDetails=function(){for(var t=0;t<this._items.length;++t)this._items[t].hideReviewDetails();this._areReviewDetailsShown=!1},E.prototype.getDragRange=function(){return this._dragMax-this._dragMin},E.prototype.getDragLimits=function(){return{min:this._dragMin,max:this._dragMax}},E.prototype._onItemReady=function(t){for(var e=0;e<this._items.length;++e)if(!this._items[e].getIsReady())return;if(this._isReady)this.parent._reportWarning("onItemsReady in RTItemsBlock unexpectedly called when ready.");else{this._totalUnscaledItemsWidth=0,this._minUnscaledItemWidth=Number.POSITIVE_INFINITY,this._maxUnscaledItemWidth=0,this._minUnscaledItemHeight=Number.POSITIVE_INFINITY,this._maxUnscaledItemHeight=0;for(var i=0;i<this._items.length;++i){var n=this._items[i].getUnscaledDimensions();this._totalUnscaledItemsWidth+=n.width,n.width>this._maxUnscaledItemWidth&&(this._maxUnscaledItemWidth=n.width),n.width<this._minUnscaledItemWidth&&(this._minUnscaledItemWidth=n.width),n.height>this._maxUnscaledItemHeight&&(this._maxUnscaledItemHeight=n.height),n.height<this._minUnscaledItemHeight&&(this._minUnscaledItemHeight=n.height)}var s;for(s=0;s<this._items.length;++s){var o=this._items[s].getElement();o.style.zIndex=s,this._element.appendChild(o)}this._nextZIndex=s,this._isReady=!0,this.parent._onItemsReady()}},E.prototype._onDragUpdate=function(t){this._sortItemsByPosition()&&(this._assignRestPositions(!0),this.parent._onOrderChanged())},E.prototype._shiftItemLeft=function(t){var e=this._getIndexOfItem(t);if(e>0){var i=this._items.splice(e-1,1)[0];if(this._items.splice(e,0,i),e<this._items.length-1){var n=this._items[e+1];this._element.insertBefore(i.getElement(),n.getElement())}else this._element.appendChild(i.getElement());this._assignRestPositions(!0),this.parent._onOrderChanged()}else t.getIsAtRest()&&t.setX(this._itemsStartX+t.getHalfWidth()-this._nudgeDistance),this._assignRestPositions(!0)},E.prototype._shiftItemRight=function(t){var e=this._getIndexOfItem(t);if(e<this._items.length-1){var i=this._items.splice(e+1,1)[0];this._items.splice(e,0,i),this._element.insertBefore(i.getElement(),t.getElement()),this._assignRestPositions(!0),this.parent._onOrderChanged()}else t.getIsAtRest()&&t.setX(this._itemsEndX-t.getHalfWidth()+this._nudgeDistance),this._assignRestPositions(!0)},E.prototype._removeChildren=function(t){for(;t.firstChild;)t.removeChild(t.firstChild)},E.prototype.getPointsFromClientPoints=function(t){for(var e=this._element.getBoundingClientRect(),i=e.left,n=e.top,s=[],o=0;o<t.length;++o){var r=t[o];s.push({x:r.x-i,y:r.y-n})}return s},E.prototype.getXFromClientX=function(t){return t-this._element.getBoundingClientRect().left},E.prototype.setPosition=function(t){this._element.style.left=t.x+"px",this._element.style.top=t.y+"px"},E.prototype.getHeight=function(){return this._element.clientHeight},E.prototype.setDimensions=function(t){if(!this._isReady)throw new Error("setDimensions called when items are not ready.");var e=this.calcParamsForDimensions(t);return this.doLayoutWithParams(e),e},E.prototype.doLayoutWithParams=function(t){if(!this._isReady)throw new Error("doLayoutWithParams called when the items are not ready.");if(t.isLayoutImpossible)throw new Error(t.layoutErrorMessage);var e;t.isTooSmallForTouch&&this.parent._reportWarning("Items may be too small for reliable touch interaction."),e=void 0!==t.height?.5*t.height:.5*t.maxItemHeight,this._itemsStartX=.5*(t.width-t.itemsRestWidth),this._itemsEndX=this._itemsStartX+t.itemsRestWidth;this._dragMin=this._itemsStartX-t.dragMargin,this._dragMin<-.7&&(this.parent._reportWarning("dragMin ("+this._dragMin+") less than zero in doLayoutWithParams."),this._dragMin=0),this._dragMax=this._itemsStartX+t.itemsRestWidth+t.dragMargin,this._dragMax>t.width+.7&&(this.parent._reportWarning("dragMax ("+this._dragMax+") greater than width ("+t.width+") in doLayoutWithParams."),this._dragMax=t.width),this._element.style.width=t.width+"px",void 0!==t.height?this._element.style.height=t.height+"px":this._element.style.height=t.maxItemHeight+"px";for(var i=0;i<this._items.length;++i){var n=this._items[i];n.setScaleAndMaxHeight(t.scale,t.maxItemHeight),n.setY(e)}return this._assignRestPositions(!1),t},E.prototype.calcOptimalHeightForWidth=function(t){if(!this._isReady)throw new Error("calcOptimalHeightForWidth called when items are not ready.");var e=this._calcDataForWidth(t);return this._enforceScaleLimits(e.maxWidthScale)*this._maxUnscaledItemHeight},E.prototype._enforceScaleLimits=function(t){return t>this._maxScale?this._maxScale:t},E.prototype._calcDataForWidth=function(t){var e={};e.unscaledSafeDragMargin=.5*(this._maxUnscaledItemWidth-this._minUnscaledItemWidth),e.fixedDragMargin=Math.max(this._nudgeDistance,this._safeDragMarginExtra),e.totalSpacing=this._itemSpacing*(this._items.length-1);var i=e.totalSpacing+2*e.fixedDragMargin;return e.maxWidthScale=(t-i)/(this._totalUnscaledItemsWidth+2*e.unscaledSafeDragMargin),e},E.prototype.calcOptimalWidth=function(){var t=this._maxScale*(this._maxUnscaledItemWidth-this._minUnscaledItemWidth),e=this._maxScale*this._totalUnscaledItemsWidth+this._itemSpacing*(this._items.length-1);return t+2*Math.max(this._nudgeDistance,this._safeDragMarginExtra)+e},E.prototype.calcParamsForDimensions=function(t){if(!this._isReady)throw new Error("calcParamsForDimensions called when items are not ready.");var e,i=this._calcDataForWidth(t.width);if(void 0!==t.height){var n=t.height/this._maxUnscaledItemHeight;e=Math.min(i.maxWidthScale,n)}else e=i.maxWidthScale;var s={scale:e=this._enforceScaleLimits(e),width:t.width,dragMargin:i.fixedDragMargin+e*i.unscaledSafeDragMargin,itemsRestWidth:i.totalSpacing+e*this._totalUnscaledItemsWidth,minItemWidth:e*this._minUnscaledItemWidth,maxItemWidth:e*this._maxUnscaledItemWidth,minItemHeight:e*this._minUnscaledItemHeight,maxItemHeight:e*this._maxUnscaledItemHeight,isLayoutImpossible:!1};if(void 0!==t.height?s.height=t.height:s.height=e*this._maxUnscaledItemHeight,s.isTooSmallForTouch=s.minItemWidth<this.parent._MIN_TOUCH_THRESHOLD||s.minItemHeight<this.parent._MIN_TOUCH_THRESHOLD,s.scale<=0){s.isLayoutImpossible=!0;var o="width: "+t.width;void 0!==t.height&&(o+=", height: "+t.height),s.layoutErrorMessage="The calculated scale is invalid (scale: "+s.scale+") for the given items block dimensions ("+o+")."}return s},E.prototype._sortItemsByPosition=function(){for(var t=0;t<this._items.length;++t)this._items[t].__prevIndex=t;this._items.sort((function(t,e){return t.getX()-e.getX()}));for(var e=!1,i=0;i<this._items.length;++i)if(this._items[i].__prevIndex!==i){e=!0;break}return e&&this._reorderElements(),e},E.prototype._reorderElements=function(){if(void 0===this._focusedItem)for(var t=0;t<this._items.length;++t){var e=this._items[t].getElement();this._element.appendChild(e)}else{for(var i=0,n=this._focusedItem.getElement();i<this._items.length;++i){var s=this._items[i];if(s===this._focusedItem){++i;break}this._element.insertBefore(s.getElement(),n)}for(;i<this._items.length;++i)this._element.appendChild(this._items[i].getElement())}},E.prototype._getIndexOfItem=function(t){var e=this._items.indexOf(t);if(-1===e)throw new Error("Item given to _getIndexOfItem is not in _items array.");return e},E.prototype._assignRestPositions=function(t){for(var e=this._itemsStartX,i=0;i<this._items.length;++i){var n=this._items[i],s=n.getHalfWidth();e+=s,n.setRestX(e,t),e+=s+this._itemSpacing}},E.prototype._bringToFront=function(t){t.getElement().style.zIndex=this._nextZIndex,this._nextZIndex+=1},E.prototype._registerFocusedItem=function(t){void 0!==this._focusedItem&&this.parent._reportWarning("A call was made to _registerFocusedItem when there was already a focused item (this is not expected)."),this._focusedItem=t},E.prototype._unregisterFocusedItem=function(t){t!==this._focusedItem&&this.parent._reportWarning("The item passed to _unregisterFocusedItem was not registered as the focused item."),this._focusedItem=void 0},E.prototype._unfocusItem=function(){void 0!==this._focusedItem&&this._focusedItem.getElement().blur()},D.prototype.getElement=function(){return this._element},D.prototype.setPosition=function(t){this._element.style.left=t.x+"px",this._element.style.top=t.y+"px"},D.prototype.setDimensions=function(t){t.width===this._elementWidth&&t.height===this._elementHeight||(this._element.style.width=t.width+"px",void 0!==t.height?this._element.style.height=t.height+"px":this._element.style.height=void 0,this._elementWidth=t.width,this._elementHeight=t.height)},D.prototype.getHeight=function(){return this._element.clientHeight},D.prototype.setBackgroundButtonIsVisibile=function(t){t!==this._backgroundButtonIsVisible&&(this._backgroundButton.style.visibility=t?"visible":"hidden",this._backgroundButtonIsVisible=t)},D.prototype.clearFeedback=function(){this._feedback.textContent=""},D.prototype.setFeedback=function(t){this._feedback.textContent=t},D.prototype.setActionButtonIsVisible=function(t){t!==this._actionButtonIsVisible&&(this._actionButton.style.visibility=t?"visible":"hidden",this._actionButtonIsVisible=t)},D.prototype.setActionButtonText=function(t){this._actionButton.name=t,this._actionButton.textContent=t},window.RankingTask=T,T.prototype.initialize=function(t,e,i){try{var n=[];this._definition=new r(t,n),n.length>0&&this._reportWarnings(n)}catch(t){return void this._enterErrorMode("The ranking task definition is not valid. "+t.message,t)}try{this._options=e}catch(t){this._enterErrorMode("The ranking task options are not valid. "+t.message,t)}this._isInitialized=!0,this.reset(i)},T.prototype.getState=function(){var t=this._mode;if(this._isGivenModeNormal(t)){for(var e={mode:t,selectedItems:[]},i=this._items.getItems(),n=0;n<i.length;++n)e.selectedItems.push(i[n].id);return e}},T.prototype.reset=function(t){if(!this._isInitialized)throw new Error("Can not reset the ranking task until it has been initialized.");var e=[];if(this._selectedItems=[],void 0!==t&&void 0!==t.selectedItems)try{if(t.selectedItems.length<2)throw new Error("The state object's selectedItems array is defined, but has too few items (at least two required).");for(var i=0;i<t.selectedItems.length;++i){var n=this._getItemByID(t.selectedItems[i]);this._selectedItems.push(n)}}catch(t){this._selectedItems=[],e.push(t.message)}if(0===this._selectedItems.length)try{var s=this._getNumToSelect();this._selectedItems=this._pickRandomItems(s)}catch(t){return void this._enterErrorMode("Unable to select items. "+t.message,t)}this._itemsAreGradable=this._checkIfItemsAreGradable(this._selectedItems);try{this._clearLayout(),e.length>0&&this._reportWarnings(e),this._question=new f(this),this._innerDiv.appendChild(this._question.getElement()),this._question.setQuestion(this._definition.question),void 0!==this._definition.media?(this._media=new y(this),this._innerDiv.appendChild(this._media.getElement()),this._media.setMedia(this._definition.media)):this._media=void 0,this._items=new E(this),this._innerDiv.appendChild(this._items.getElement()),this._footer=new D(this),this._innerDiv.appendChild(this._footer.getElement()),this._footer.setBackgroundButtonIsVisibile(void 0!==this._definition.background),this._layout1=new c(this,this._question,this._items,this._footer),this._layout2=new u(this,this._question,this._media,this._items,this._footer),this._layout3=new p(this,this._question,this._media,this._items,this._footer);var o=void 0,r=void 0;void 0!==t&&void 0!==t.mode&&(o=parseInt(t.mode),r=t.feedback,this._isGivenModeNormal(o)?3!==o&&4!==o||(this._reportWarning("Setting a review mode via the state object is not currently supported."),o=void 0,r=void 0):(this._reportWarning("The mode property of the state object is invalid."),o=void 0,r=void 0)),void 0!==o?this._setMode(o,r):this._itemsAreGradable?this._setMode(this._MODE_ACTIVE_GRADABLE):this._setMode(this._MODE_ACTIVE_NOT_GRADABLE),void 0!==this._definition.media&&"labeledImage"===this._definition.media.type&&this._media.setItems(this._selectedItems),this._items.setItems(this._selectedItems)}catch(t){return void this._enterErrorMode("Unable to initialize the ranking task. See console for details.",t)}},T.prototype.grade=function(t){if(this._mode!==this._MODE_ACTIVE_GRADABLE&&this._mode!==this._MODE_ACTIVE_NOT_GRADABLE)throw new Error("Grading is possible only when the ranking task is in 'Active Gradable' or 'Active Not Gradable' mode.");this._items.lock();var e=this._items.getItems();if(!this._checkIfItemsAreGradable(e))throw new Error("Grading is possible only when there at least two items selected and all items have a valid value.");var i=e.slice();i.sort((function(t,e){return t.value-e.value}));for(var n=[],s={value:Number.NEGATIVE_INFINITY},o=0;o<i.length;++o){var r=i[o];r.value===s.value?s.maxIndex=o:s={value:r.value,minIndex:o,maxIndex:o},r.__rank=s,n.push(!1)}for(var a=!0,h=0;h<e.length;++h){var d=e[h];d.__rank.minIndex<=h&&h<=d.__rank.maxIndex?(d.isCorrect=!0,d.order=h+1,n[h]=!0):(d.isCorrect=!1,a=!1)}for(var c=0;c<e.length;++c){var l=e[c];if(!l.isCorrect){var _=void 0;for(_=l.__rank.minIndex;_<=l.__rank.maxIndex;++_)if(!n[_]){l.order=_+1,n[_]=!0;break}if(_>l.__rank.maxIndex)throw new Error("Programming error in grade function. Unable to assign an order to an incorrectly placed item.")}}var m=a?"Correct!":"Incorrect!";void 0!==t&&t?this._setMode(this._MODE_REVIEW_NOT_RESETTABLE,m):this._setMode(this._MODE_REVIEW_RESETTABLE,m)},T.prototype._trace=function(t){console.log("RT ("+this._debugName+"): "+t)},T.prototype._enterErrorMode=function(t,e){this._clearLayout(),this._innerDiv.textContent=t,this._savedRootBackgroundColor=this._rootElement.style.backgroundColor,this._rootElement.style.backgroundColor="#ffe7e8";var i="RT ("+this._debugName+"): "+t;console.error(i),console.error(e),this._mode=this._MODE_ERROR},T.prototype._reportWarnings=function(t){for(var e=0;e<t.length;++e)this._reportWarning(t[e])},T.prototype._reportWarning=function(t){console.warn("RT ("+this._debugName+"): "+t)},T.prototype._isGivenModeNormal=function(t){return t===this._MODE_ACTIVE_GRADABLE||t===this._MODE_ACTIVE_NOT_GRADABLE||t===this._MODE_REVIEW_RESETTABLE||t===this._MODE_REVIEW_NOT_RESETTABLE},T.prototype._setMode=function(t,e){if(t===this._MODE_ACTIVE_GRADABLE)this._items.unlock(),this._items.hideReviewDetails(),this._footer.setActionButtonText("Grade"),this._footer.setActionButtonIsVisible(!0);else if(t===this._MODE_ACTIVE_NOT_GRADABLE)this._items.unlock(),this._items.hideReviewDetails(),this._footer.setActionButtonIsVisible(!1);else if(t===this._MODE_REVIEW_RESETTABLE)this._items.lock(),this._items.showReviewDetails(),this._footer.setActionButtonText("Reset"),this._footer.setActionButtonIsVisible(!0);else{if(t!==this._MODE_REVIEW_NOT_RESETTABLE)throw new Error("setMode is for normal modes only.");this._items.lock(),this._items.showReviewDetails(),this._footer.setActionButtonIsVisible(!1)}void 0!==e?this._footer.setFeedback(e):this._footer.clearFeedback(),this._mode=t},T.prototype._clearLayout=function(){var t=this;this._mode===this._MODE_UNDEFINED&&(this.resetInnerHeightLimit(),this._removeChildren(this._rootElement),this._innerDiv=document.createElement("div"),this._innerDiv.className="rt-inner",this._rootElement.appendChild(this._innerDiv),this._innerDivStyle=window.getComputedStyle(this._innerDiv),this._resizeSensor=new s.a(this._rootElement,(function(){t.resetLayout()}))),this._removeChildren(this._innerDiv),void 0!==this._savedRootBackgroundColor&&(this._rootElement.style.backgroundColor=this._savedRootBackgroundColor,this._savedRootBackgroundColor=void 0)},T.prototype._limitPrecision=function(t){return Math.round(100*t)/100},T.prototype.resetLayout=function(t){if(!(this._mode<=0)&&this._items.getIsReady()&&(void 0===this._media||this._media.getIsReady())){var e=this._limitPrecision(parseFloat(this._rootStyle.width)),i=this._limitPrecision(parseFloat(this._rootStyle.height));if(e!==this._lastRootWidth||i!==this._lastRootHeight||!0===t)if(this._isDoingLayoutReset)this._reportWarning("Recursive call to resetLayout detected.");else{this._isDoingLayoutReset=!0;try{if(this.resetInnerHeightLimit(),this._innerWidth=this._limitPrecision(parseFloat(this._innerDivStyle.width)),this._rootPadding=parseFloat(this._rootStyle.paddingTop),this._spacing=this._rootPadding,this._items.setItemSpacing(this._spacing),void 0===this._media)this._layout1.doLayout();else{var n=this._layout2.calcParams(),s=this._layout3.calcParams();n.avgScale>s.avgScale?this._layout2.doLayoutWithParams(n):this._layout3.doLayoutWithParams(s)}this._lastRootWidth=this.getRootWidth(),this._lastRootHeight=this.getRootHeight()}catch(t){this._enterErrorMode("Layout failed. "+t.message,t)}finally{this._isDoingLayoutReset=!1}}}},T.prototype.getBorderWidth=function(){return parseFloat(this._rootStyle.borderTopWidth)},T.prototype.getRootHeight=function(){return this._limitPrecision(parseFloat(this._rootStyle.height))},T.prototype.getRootWidth=function(){return this._limitPrecision(parseFloat(this._rootStyle.width))},T.prototype.getInnerWidth=function(){return this._limitPrecision(parseFloat(this._innerDivStyle.width))},T.prototype.getInnerHeight=function(){return this._limitPrecision(parseFloat(this._innerDivStyle.height))},T.prototype.getSpacing=function(){return this._spacing},T.prototype.resetInnerHeightLimit=function(){this._maxInnerHeight=void 0,this._maxInnerHeightTested=Number.NEGATIVE_INFINITY},T.prototype.getMaxInnerHeight=function(){return this._maxInnerHeight},T.prototype.doesInnerHeightExceedLimit=function(t){if(void 0!==this._maxInnerHeight){return t>this._maxInnerHeight+1.1}return!(t<=this._maxInnerHeightTested)&&this.setInnerHeight(t)},T.prototype.setInnerHeight=function(t){this._innerDiv.style.height=t+"px";var e=this._rootElement.clientHeight-2*this._rootPadding;return t>e+1.1?(this._maxInnerHeight=e,!0):(this._maxInnerHeightTested<t&&(this._maxInnerHeightTested=t),!1)},T.prototype._onOrderChanged=function(){},T.prototype._onActionButtonClick=function(){this._mode===this._MODE_ACTIVE_GRADABLE?this.grade():this._mode===this._MODE_REVIEW_RESETTABLE?this.reset():this._reportWarning("Action button clicked with invalid mode ("+this._mode+").")},T.prototype._onBackgroundButtonClick=function(){void 0!==this._definition&&void 0!==this._definition.background?window.open(this._getExpandedURL(this._definition.background.src,"rt_background")):this._reportWarning("The background button was clicked without a valid background page defined.")},T.prototype._onItemsReady=function(){this.resetLayout(!0)},T.prototype._onMediaReady=function(){this.resetLayout(!0)},T.prototype._getExpandedURL=function(t){if(void 0===this._options||void 0===this._options.baseURL)return t;try{return new URL(t,this._options.baseURL).toString()}catch(e){return this._reportWarning("URL creation in getCompleteURL failed."),t}},T.prototype._checkIfItemsAreGradable=function(t){if(t.length<2)return!1;for(var e=0;e<t.length;++e)if(void 0===t[e].value)return!1;return!0},T.prototype._getNumToSelect=function(){function t(t){return!Number.isNaN(t)&&t>=2&&t<=20}if(void 0!==this._definition.numToSelect){var e=parseInt(this._definition.numToSelect);if(t(e))return e;this._reportWarning("The definition object's numToSelect is defined, but invalid.")}if(void 0!==this._options&&void 0!==this._options.defaultNumToSelect){var i=parseInt(this._options.defaultNumToSelect);if(t(i))return i;this._reportWarning("The options object's defaultNumToSelect is defined, but invalid.")}return 5},T.prototype._pickRandomItems=function(t){var e=this._definition.bins,i=void 0;if(!Array.isArray(e))throw new Error("The definition object does not have a bins array.");for(var n=this._shuffle(e),s=0;s<n.length;++s)n[s].items=this._shuffle(n[s].items);for(var o=[],r=0;o.length<t;){var a=0;for(s=0;s<n.length;++s){var h=n[s].items;if(!(h.length<=r)&&(o.push(h[r]),a+=1,o.length>=t))break}if(0===a)break;r+=1}if((i=this._shuffle(o)).length<2)throw new Error("Insufficient items in the definition object (at least two required).");return i},T.prototype._getItemByID=function(t){for(var e=this._definition.bins,i=0;i<e.length;++i)for(var n=e[i].items,s=0;s<n.length;++s){var o=n[s];if(o.id===t)return o}throw new Error("Unable to find item with ID '"+t+"' in the ranking task definition.")},T.prototype._removeChildren=function(t){for(;t.firstChild;)t.removeChild(t.firstChild)},T.prototype._shuffle=function(t){for(var e,i,n=t.slice(0),s=n.length;0!==s;)i=Math.floor(Math.random()*s),e=n[s-=1],n[s]=n[i],n[i]=e;return n}}]);